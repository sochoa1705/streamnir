<section *ngIf="flight">
	<div class="tags" *ngIf="idCheap == flight.id || idBest == flight.id">
		<picture *ngIf="idCheap == flight.id">
			<source srcset="./assets/svg/badge_cheap.svg" media="(min-width: 575px)" />
			<img src="./assets/svg/best-cheap-mob.svg" alt="mas_barato" />
		</picture>

		<picture *ngIf="idBest == flight.id">
			<source srcset="./assets/svg/badge_best.svg" media="(min-width: 575px)" />
			<img src="./assets/svg/best-option-mob.svg" alt="mejor_opcion" />
		</picture>
	</div>

	<div class="card__result">
		<div class="card__result__flights">
			<!--------------Section Departure (pueden ser varios | multivuelo)------------------->
			<ng-container *ngFor="let departure of flight.departure; index as i">
				<div class="card__result__flights__section">
					<div class="card__result__flights__section__header">
						<img
							class="img"
							[src]="departure.segments[indexSegmentDeparture[i]].flightSegments[0].marketingAirline.imageUrl"
							onerror="this.src='https://www.nmviajes.com/resources/images/airlines/MULT.gif'"
						/>
						<h4 class="fly">{{ departure.originCity.code }}</h4>
						<img class="arrow" width="24" height="24" src="./assets/result-search/arrow.svg" />
						<h4 class="fly2">{{ departure.destinationCity.code }}</h4>
						<div class="date date d-none d-sm-block">
							{{ (departure.departureDate | formdate | date: 'EE d MMM')?.split('.')?.join(' ') }}
						</div>
					</div>

					<!---init-->
					<div class="card__result__flights__section__options" [hidden]="showHoursDeparture">
						<div class="segment">
							<img class="segment__radio" src="./assets/svg/radio-check.svg" style="visibility: hidden" />
							<div class="segment__detail">
								<div class="segment__detail__hours">
									<app-tooltip-arrival [segment]="departure.segments[indexSegmentDeparture[i]]"></app-tooltip-arrival>
									<span class="duration">{{
										departure.segments[indexSegmentDeparture[i]].flightDuration | flightDuration
									}}</span>
								</div>
								<ng-container [ngSwitch]="departure.segments[indexSegmentDeparture[i]].stops">
									<span class="scala" *ngSwitchCase="0">Directo</span>
									<span class="scala" *ngSwitchCase="1">1 escala</span>
									<span class="scala" *ngSwitchDefault>{{
										departure.segments[indexSegmentDeparture[i]].stops + ' escalas'
									}}</span>
								</ng-container>
								<app-tooltip
									[isHandLuggage]="departure.segments[indexSegmentDeparture[i]].equipaje?.cabina ? true : false"
									[isHoldLuggage]="
										departure.segments[indexSegmentDeparture[i]].equipaje?.piezas ?? 0 > 0 ? true : false
									"
								></app-tooltip>
							</div>
						</div>
					</div>
					<!----------Others options hours-------->

					<ng-container *ngIf="departure.segments.length > 1">
						<div class="card__result__flights__section__options" [hidden]="!showHoursDeparture">
							<div class="segment" *ngFor="let segment of departure.segments; index as i2">
								<img
									class="segment__radio"
									[src]="
										i2 == indexSegmentDeparture[i] ? 'assets/svg/radio-check.svg' : './assets/svg/radio-circle.svg'
									"
									(click)="changeSegmentDeparture(i, i2, segment.segmentId)"
								/>
								<div class="segment__detail">
									<div class="segment__detail__hours">
										<app-tooltip-arrival [segment]="segment"></app-tooltip-arrival>
										<span class="duration">{{ segment.flightDuration | flightDuration }}</span>
									</div>
									<ng-container [ngSwitch]="segment.stops">
										<span class="scala" *ngSwitchCase="0">Directo</span>
										<span class="scala" *ngSwitchCase="1">1 escala</span>
										<span class="scala" *ngSwitchDefault>{{ segment.stops + ' escalas' }}</span>
									</ng-container>
									<app-tooltip
										[isHandLuggage]="segment.equipaje.cabina ? true : false"
										[isHoldLuggage]="segment.equipaje.piezas > 0 ? true : false"
									></app-tooltip>
								</div>
							</div>
						</div>
						<!--------End Others options hours-------->
						<div class="card__result__flights__section__more" (click)="showHoursDeparture = !showHoursDeparture">
							<span
								><span>{{ !showHoursDeparture ? 'Ver más horarios' : 'Ver menos horarios' }}</span></span
							>
							<img
								[src]="
									!showHoursDeparture ? './assets/result-search/dropdown.svg' : './assets/result-search/dropup.svg'
								"
								alt="v"
							/>
						</div>
					</ng-container>
					<!--end-->
				</div>
				<div class="card__result__flights__line" *ngIf="i < flight.departure.length - 1"></div>
			</ng-container>
			<!---------------------Section Return--------------------------------------------------->
			<div class="card__result__flights__section" *ngIf="flight.returns as returns">
				<div class="card__result__flights__line"></div>
				<div class="card__result__flights__section__header">
					<img
						class="img"
						[src]="returns.segments[indexSegmentReturn].flightSegments[0].marketingAirline.imageUrl"
						onerror="this.src='https://www.nmviajes.com/resources/images/airlines/MULT.gif'"
					/>
					<h4 class="fly">{{ returns.originCity.code }}</h4>
					<img class="arrow" width="24" height="24" src="./assets/result-search/arrow.svg" />
					<h4 class="fly2">{{ returns.destinationCity.code }}</h4>
					<div class="date date d-none d-sm-block">
						{{ (returns.departureDate | formdate | date: 'EE d MMM')?.split('.')?.join(' ') }}
					</div>
				</div>

				<div class="card__result__flights__section__options" [hidden]="showHoursReturn">
					<div class="segment">
						<img class="segment__radio" src="./assets/svg/radio-check.svg" style="visibility: hidden" />
						<div class="segment__detail">
							<div class="segment__detail__hours">
								<app-tooltip-arrival [segment]="returns.segments[indexSegmentReturn]"></app-tooltip-arrival>
								<span class="duration">{{ returns.segments[indexSegmentReturn].flightDuration | flightDuration }}</span>
							</div>

							<ng-container [ngSwitch]="returns.segments[indexSegmentReturn].stops">
								<span class="scala" *ngSwitchCase="0">Directo</span>
								<span class="scala" *ngSwitchCase="1">1 escala</span>
								<span class="scala" *ngSwitchDefault>{{
									returns.segments[indexSegmentReturn].stops + ' escalas'
								}}</span>
							</ng-container>

							<app-tooltip
								[isHandLuggage]="returns.segments[indexSegmentReturn].equipaje?.cabina ? true : false"
								[isHoldLuggage]="returns.segments[indexSegmentReturn].equipaje?.piezas ?? 0 > 0 ? true : false"
							></app-tooltip>
						</div>
					</div>
				</div>

				<!----------Others options hours-------->

				<ng-container *ngIf="returns.segments.length > 1">
					<div class="card__result__flights__section__options" [hidden]="!showHoursReturn">
						<div class="segment" *ngFor="let segment of returns.segments; index as i">
							<img
								class="segment__radio"
								[src]="i == indexSegmentReturn ? './assets/svg/radio-check.svg' : './assets/svg/radio-circle.svg'"
								(click)="changeSegmentReturn(i, segment.segmentId)"
							/>
							<div class="segment__detail">
								<div class="segment__detail__hours">
									<app-tooltip-arrival [segment]="segment"></app-tooltip-arrival>
									<span class="duration">{{ segment.flightDuration | flightDuration }}</span>
								</div>

								<ng-container [ngSwitch]="segment.stops">
									<span class="scala" *ngSwitchCase="0">Directo</span>
									<span class="scala" *ngSwitchCase="1">1 escala</span>
									<span class="scala" *ngSwitchDefault>{{ segment.stops + ' escalas' }}</span>
								</ng-container>

								<app-tooltip
									[isHandLuggage]="segment.equipaje?.cabina ? true : false"
									[isHoldLuggage]="segment.equipaje?.piezas ?? 0 > 0 ? true : false"
								></app-tooltip>
							</div>
						</div>
					</div>
					<!--------End Others options hours-------->
					<div class="card__result__flights__section__more" (click)="showHoursReturn = !showHoursReturn">
						<span>{{ !showHoursReturn ? 'Ver más horarios' : 'Ver menos horarios' }}</span>
						<img
							[src]="!showHoursReturn ? './assets/result-search/dropdown.svg' : './assets/result-search/dropup.svg'"
							alt="v"
						/>
					</div>
				</ng-container>
			</div>
		</div>

		<!-------------------Section Pricing-------------------->

		<div class="card__result__pricemobile" *ngIf="flight.detailPricing">
			<div class="card__result__pricemobile__actions">
				<h4>
					<span>{{ currency }}</span> {{ flight.detailPricing.totalPay | changeCurrency: currency | number: '1.2-2' }}
				</h4>
				<article>
					<app-button
						[text]="'Ver Detalle'"
						[isMobile2]="true"
						[w100]="true"
						(onClick)="openModalDetail()"
					></app-button>
				</article>
			</div>
			<span class="card__result__pricemobile__detail">¿Que incluye este precio?</span>
		</div>

		<div class="card__result__price">
			<ng-container *ngIf="flight.detailPricing">
				<h4>
					<span>{{ currency }}</span>
					{{ flight.detailPricing.totalPay | changeCurrency: currency | number: '1.2-2' }}
				</h4>
				<div class="card__result__price__detail">
					<div class="card__result__price__detail__row">
						<span
							>{{ flight.detailPricing.totalADT }} {{ flight.detailPricing.totalADT > 1 ? 'ADULTOS' : 'ADULTO' }}</span
						>
						<span class="total"
							><span class="usd">{{ currency }}</span
							>{{
								flight.detailPricing.baseFareADT * flight.detailPricing.totalADT
									| changeCurrency: currency
									| number: '1.2-2'
							}}
						</span>
					</div>

					<div class="card__result__price__detail__row" *ngIf="flight.detailPricing.totalCNN > 0">
						<span>{{ flight.detailPricing.totalCNN }} {{ flight.detailPricing.totalCNN > 1 ? 'NIÑOS' : 'NIÑO' }}</span>
						<span class="total"
							><span class="usd">{{ currency }}</span
							>{{
								flight.detailPricing.baseFareCNN * flight.detailPricing.totalCNN
									| changeCurrency: currency
									| number: '1.2-2'
							}}
						</span>
					</div>

					<div class="card__result__price__detail__row" *ngIf="flight.detailPricing.totalINF > 0">
						<span
							>{{ flight.detailPricing.totalINF }}
							{{ flight.detailPricing.totalINF > 1 ? 'INFANTES' : 'INFANTE' }}</span
						>
						<span class="total"
							><span class="usd">{{ currency }}</span
							>{{
								flight.detailPricing.baseFareINF * flight.detailPricing.totalINF
									| changeCurrency: currency
									| number: '1.2-2'
							}}
						</span>
					</div>

					<div class="card__result__price__detail__row">
						<span>IMPUESTOS</span>
						<span class="total"
							><span class="usd">{{ currency }}</span
							>{{ flight.detailPricing.taxes | changeCurrency: currency | number: '1.2-2' }}</span
						>
					</div>
					<div class="card__result__price__detail__row">
						<span>CARGOS</span>
						<span class="total"
							><span class="usd">{{ currency }}</span
							>{{
								flight.detailPricing.feeNMV + flight.detailPricing.feePTA | changeCurrency: currency | number: '1.2-2'
							}}</span
						>
					</div>
				</div>
				<div class="card__result__price__button">
					<app-button
						[text]="'Ver Detalle'"
						[w100]="true"
						[isMobile2]="true"
						(onClick)="openModalDetail()"
					></app-button>
				</div>
			</ng-container>
		</div>
	</div>
</section>
